{"code":"(this.webpackJsonpstreamlit_cookie_manager=this.webpackJsonpstreamlit_cookie_manager||[]).push([[0],{5:function(e,o,n){\"use strict\";n.r(o);var t=n(2),a=(window.parent||window).document,c=null;t.a.events.addEventListener(t.a.RENDER_EVENT,(function(e){var o,n=e.detail;o=n.args.queue,Object.keys(o).forEach((function(e){var n=o[e];if(null===n.value)console.log(\"saving cookie\",\"\".concat(encodeURIComponent(e),\"=; max-age=0; path=\").concat(encodeURIComponent(n.path))),a.cookie=\"\".concat(encodeURIComponent(e),\"=; max-age=0; path=\").concat(encodeURIComponent(n.path));else{var t=new Date(n.expires_at);console.log(\"saving cookie\",\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(n.value),\";\")+\" expires=\".concat(t.toUTCString(),\";\")+\" path=\".concat(encodeURIComponent(n.path),\";\")),a.cookie=\"\".concat(encodeURIComponent(e),\"=\").concat(encodeURIComponent(n.value),\";\")+\" expires=\".concat(t.toUTCString(),\";\")+\" path=\".concat(encodeURIComponent(n.path),\";\")}}));var p=a.cookie;c===p||n.args.saveOnly||(t.a.setComponentValue(p),c=p)})),t.a.setComponentReady(),t.a.setFrameHeight(0)}},[[5,1,2]]]);","name":"static/js/main.5e4f87a4.chunk.js","map":{"version":3,"sources":["static/js/main.5e4f87a4.chunk.js"],"names":["this","push","module","__webpack_exports__","__webpack_require__","r","streamlit_component_lib__WEBPACK_IMPORTED_MODULE_0__","targetDocument","window","parent","document","lastValue","events","addEventListener","RENDER_EVENT","event","queue","data","detail","args","Object","keys","forEach","name","spec","value","console","log","concat","encodeURIComponent","path","cookie","date","Date","expires_at","toUTCString","newValue","saveOnly","setComponentValue","setComponentReady","setFrameHeight"],"mappings":"CAACA,KAA2C,qCAAIA,KAA2C,sCAAK,IAAIC,KAAK,CAAC,CAAC,GAAG,CAExG,EACA,SAAUC,EAAQC,EAAqBC,GAE7C,aACAA,EAAoBC,EAAEF,GACD,IAAIG,EAAuDF,EAAoB,GACzDG,GAA1BC,OAAOC,QAAQD,QAAuCE,SAAaC,EAAU,KAAgSL,EAAwE,EAAEM,OAAOC,iBAAiBP,EAAwE,EAAEQ,cAAvc,SAAkBC,GAAO,IAAopBC,EAAhpBC,EAAKF,EAAMG,OAAqoBF,EAAlnBC,EAAKE,KAAY,MAAwmBC,OAAOC,KAAKL,GAAOM,SAAQ,SAASC,GAAM,IAAIC,EAAKR,EAAMO,GAAM,GAAgB,OAAbC,EAAKC,MAAcC,QAAQC,IAAI,gBAAgB,GAAGC,OAAOC,mBAAmBN,GAAM,uBAAuBK,OAAOC,mBAAmBL,EAAKM,QAAQvB,EAAewB,OAAO,GAAGH,OAAOC,mBAAmBN,GAAM,uBAAuBK,OAAOC,mBAAmBL,EAAKM,WAAY,CAAC,IAAIE,EAAK,IAAIC,KAAKT,EAAKU,YAAYR,QAAQC,IAAI,gBAAgB,GAAGC,OAAOC,mBAAmBN,GAAM,KAAKK,OAAOC,mBAAmBL,EAAKC,OAAO,KAAK,YAAYG,OAAOI,EAAKG,cAAc,KAAK,SAASP,OAAOC,mBAAmBL,EAAKM,MAAM,MAAMvB,EAAewB,OAAO,GAAGH,OAAOC,mBAAmBN,GAAM,KAAKK,OAAOC,mBAAmBL,EAAKC,OAAO,KAAK,YAAYG,OAAOI,EAAKG,cAAc,KAAK,SAASP,OAAOC,mBAAmBL,EAAKM,MAAM,SAAt2C,IAAIM,EAAS7B,EAAewB,OAAUpB,IAAYyB,GAAWnB,EAAKE,KAAKkB,WAAU/B,EAAwE,EAAEgC,kBAAkBF,GAAUzB,EAAUyB,MAA8M9B,EAAwE,EAAEiC,oBAAoBjC,EAAwE,EAAEkC,eAAe,KAItvB,CAAC,CAAC,EAAE,EAAE"},"input":"(this[\"webpackJsonpstreamlit_cookie_manager\"] = this[\"webpackJsonpstreamlit_cookie_manager\"] || []).push([[0],{\n\n/***/ 5:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var streamlit_component_lib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(2);\nvar targetWindow=window.parent||window;var targetDocument=targetWindow.document;var lastValue=null;function onRender(event){var data=event.detail;saveCookies(data.args[\"queue\"]);var newValue=targetDocument.cookie;if(lastValue!==newValue&&!data.args.saveOnly){streamlit_component_lib__WEBPACK_IMPORTED_MODULE_0__[/* Streamlit */ \"a\"].setComponentValue(newValue);lastValue=newValue;}}streamlit_component_lib__WEBPACK_IMPORTED_MODULE_0__[/* Streamlit */ \"a\"].events.addEventListener(streamlit_component_lib__WEBPACK_IMPORTED_MODULE_0__[/* Streamlit */ \"a\"].RENDER_EVENT,onRender);streamlit_component_lib__WEBPACK_IMPORTED_MODULE_0__[/* Streamlit */ \"a\"].setComponentReady();streamlit_component_lib__WEBPACK_IMPORTED_MODULE_0__[/* Streamlit */ \"a\"].setFrameHeight(0);function saveCookies(queue){Object.keys(queue).forEach(function(name){var spec=queue[name];if(spec.value===null){console.log('saving cookie',\"\".concat(encodeURIComponent(name),\"=; max-age=0; path=\").concat(encodeURIComponent(spec.path)));targetDocument.cookie=\"\".concat(encodeURIComponent(name),\"=; max-age=0; path=\").concat(encodeURIComponent(spec.path));}else{var date=new Date(spec.expires_at);console.log('saving cookie',\"\".concat(encodeURIComponent(name),\"=\").concat(encodeURIComponent(spec.value),\";\")+\" expires=\".concat(date.toUTCString(),\";\")+\" path=\".concat(encodeURIComponent(spec.path),\";\"));targetDocument.cookie=\"\".concat(encodeURIComponent(name),\"=\").concat(encodeURIComponent(spec.value),\";\")+\" expires=\".concat(date.toUTCString(),\";\")+\" path=\".concat(encodeURIComponent(spec.path),\";\");}});}\n\n/***/ })\n\n},[[5,1,2]]]);","inputSourceMap":{"version":3,"sources":["/Users/michalmizera/Repos/StreamlitMiami/lib/streamlit_cookies_manager/src/index.ts"],"names":["targetWindow","window","parent","targetDocument","document","lastValue","onRender","event","data","detail","saveCookies","args","newValue","cookie","saveOnly","Streamlit","setComponentValue","events","addEventListener","RENDER_EVENT","setComponentReady","setFrameHeight","queue","Object","keys","forEach","name","spec","value","console","log","encodeURIComponent","path","date","Date","expires_at","toUTCString"],"mappings":";;;;;;AAAA;AAAA;AAEA,GAAMA,aAAoB,CAAGC,MAAM,CAACC,MAAP,EAAiBD,MAA9C,CACA,GAAME,eAAc,CAAGH,YAAY,CAACI,QAApC,CAEA,GAAIC,UAAwB,CAAG,IAA/B,CAeA,QAASC,SAAT,CAAkBC,KAAlB,CAAsC,CAClC,GAAMC,KAAI,CAAID,KAAD,CAAmCE,MAAhD,CAEAC,WAAW,CAACF,IAAI,CAACG,IAAL,CAAU,OAAV,CAAD,CAAX,CAEA,GAAMC,SAAQ,CAAGT,cAAc,CAACU,MAAhC,CACA,GAAIR,SAAS,GAAKO,QAAd,EAA0B,CAACJ,IAAI,CAACG,IAAL,CAAUG,QAAzC,CAAmD,CAC/CC,yEAAS,CAACC,iBAAV,CAA4BJ,QAA5B,EACAP,SAAS,CAAGO,QAAZ,CACH,CACJ,CAEDG,yEAAS,CAACE,MAAV,CAAiBC,gBAAjB,CAAkCH,yEAAS,CAACI,YAA5C,CAA0Db,QAA1D,EACAS,yEAAS,CAACK,iBAAV,GACAL,yEAAS,CAACM,cAAV,CAAyB,CAAzB,EAGA,QAASX,YAAT,CAAqBY,KAArB,CAA2D,CACvDC,MAAM,CAACC,IAAP,CAAYF,KAAZ,EAAmBG,OAAnB,CAA2B,SAACC,IAAD,CAAU,CACjC,GAAMC,KAAI,CAAGL,KAAK,CAACI,IAAD,CAAlB,CACA,GAAIC,IAAI,CAACC,KAAL,GAAe,IAAnB,CAAwB,CACpBC,OAAO,CAACC,GAAR,CAAY,eAAZ,WAAgCC,kBAAkB,CAACL,IAAD,CAAlD,+BAA8EK,kBAAkB,CAACJ,IAAI,CAACK,IAAN,CAAhG,GACA7B,cAAc,CAACU,MAAf,WAA2BkB,kBAAkB,CAACL,IAAD,CAA7C,+BAAyEK,kBAAkB,CAACJ,IAAI,CAACK,IAAN,CAA3F,EACC,CAHL,IAIK,CACD,GAAMC,KAAI,CAAG,GAAIC,KAAJ,CAASP,IAAI,CAACQ,UAAd,CAAb,CACAN,OAAO,CAACC,GAAR,CAAY,eAAZ,CACI,UAAGC,kBAAkB,CAACL,IAAD,CAArB,aAA+BK,kBAAkB,CAACJ,IAAI,CAACC,KAAN,CAAjD,yBACYK,IAAI,CAACG,WAAL,EADZ,sBAESL,kBAAkB,CAACJ,IAAI,CAACK,IAAN,CAF3B,KADJ,EAKA7B,cAAc,CAACU,MAAf,CACI,UAAGkB,kBAAkB,CAACL,IAAD,CAArB,aAA+BK,kBAAkB,CAACJ,IAAI,CAACC,KAAN,CAAjD,yBACYK,IAAI,CAACG,WAAL,EADZ,sBAESL,kBAAkB,CAACJ,IAAI,CAACK,IAAN,CAF3B,KADJ,CAKH,CACJ,CAnBD,EAoBH,C","file":"x","sourcesContent":["import {RenderData, Streamlit} from \"streamlit-component-lib\"\n\nconst targetWindow: Window = window.parent || window\nconst targetDocument = targetWindow.document\n\nlet lastValue: string | null = null\n\ninterface AddCookieSpec {\n    value: string\n    expires_at: string\n    path: string\n}\n\ninterface DeleteCookieSpec {\n    value: null\n    path: string\n}\n\ntype CookieSpec = AddCookieSpec | DeleteCookieSpec\n\nfunction onRender(event: Event): void {\n    const data = (event as CustomEvent<RenderData>).detail\n\n    saveCookies(data.args[\"queue\"])\n\n    const newValue = targetDocument.cookie\n    if (lastValue !== newValue && !data.args.saveOnly) {\n        Streamlit.setComponentValue(newValue)\n        lastValue = newValue\n    }\n}\n\nStreamlit.events.addEventListener(Streamlit.RENDER_EVENT, onRender)\nStreamlit.setComponentReady()\nStreamlit.setFrameHeight(0)\n\n\nfunction saveCookies(queue: { [k in string]: CookieSpec }) {\n    Object.keys(queue).forEach((name) => {\n        const spec = queue[name]\n        if (spec.value === null){\n            console.log('saving cookie', `${encodeURIComponent(name)}=; max-age=0; path=${encodeURIComponent(spec.path)}`)\n            targetDocument.cookie = `${encodeURIComponent(name)}=; max-age=0; path=${encodeURIComponent(spec.path)}`\n            }\n        else {\n            const date = new Date(spec.expires_at)\n            console.log('saving cookie', (\n                `${encodeURIComponent(name)}=${encodeURIComponent(spec.value)};` +\n                ` expires=${date.toUTCString()};` +\n                ` path=${encodeURIComponent(spec.path)};`\n            ))\n            targetDocument.cookie = (\n                `${encodeURIComponent(name)}=${encodeURIComponent(spec.value)};` +\n                ` expires=${date.toUTCString()};` +\n                ` path=${encodeURIComponent(spec.path)};`\n            )\n        }\n    })\n}"]}}